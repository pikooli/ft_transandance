{"ast":null,"code":"import consumer from \"./consumer\";\n/* --- chat --- */\n\nimport { unsubAll } from '../chat/index';\n/* ------------ */\n\nimport PONG from \"../nav/pong\";\nimport GAME from \"../nav/game\";\nGAME.channel = consumer.subscriptions.create(\"PongChannel\", {\n  received: function received(data) {\n    switch (data.action) {\n      case 0:\n        if (PONG.view == null) {\n          /* --- chat --- */\n          unsubAll();\n          /* ------------ */\n\n          PONG.view = new PONG.View({\n            el: $(\"#main\")\n          });\n        }\n\n        $('#playerleft').html('[' + data.playerLeft + ']' + ' ');\n        $('#playerright').html(' ' + '[' + data.playerRight + ']');\n        $(\"#pongPlay input[value='Start']\").off(\"click\");\n        $(\"#pongPlay input[value='Stop']\").on(\"click\", PONG.stop);\n        $(document).on(\"keydown\", PONG.keydown);\n        $(document).on(\"keyup\", PONG.keyup);\n\n        if (data.host == true) {\n          GAME.initialize(data.playerLeft, data.playerRight, PONG.width, PONG.height, PONG.fill);\n          GAME.loop();\n        } else {\n          GAME.data = {\n            playerLeft: data.playerLeft,\n            playerRight: data.playerRight,\n            direction: 0,\n            score: {},\n            attributes: {}\n          };\n        }\n\n        break;\n\n      case 1:\n        GAME.game = false;\n        break;\n\n      case 2:\n        GAME.leftPaddleDirectionY = data.direction;\n        break;\n\n      case 3:\n        GAME.rightPaddleDirectionY = data.direction;\n        break;\n\n      case 4:\n        GAME.channel.perform(\"reset\", data);\n        break;\n\n      default:\n        if (PONG.score) {\n          PONG.score.render(data.score);\n          PONG.ball.render(data.ball);\n          PONG.leftPaddle.render(data.leftPaddle);\n          PONG.rightPaddle.render(data.rightPaddle);\n        }\n\n    }\n  }\n});\n\nPONG.start = function () {\n  if (PONG.players.count == 2) {\n    GAME.channel.perform(\"start\", {\n      playerLeft: PONG.players.playerLeft,\n      playerRight: PONG.players.playerRight\n    });\n  }\n};\n\nPONG.stop = function () {\n  GAME.channel.perform(\"stop\", GAME.data);\n};\n\nPONG.keydown = function (event) {\n  if (event.repeat != true) {\n    switch (event.key) {\n      case \"w\":\n        GAME.data.direction = -1;\n        GAME.channel.perform(\"direction\", GAME.data);\n        break;\n\n      case \"s\":\n        GAME.data.direction = 1;\n        GAME.channel.perform(\"direction\", GAME.data);\n    }\n  }\n};\n\nPONG.keyup = function (event) {\n  switch (event.key) {\n    case \"w\":\n    case \"s\":\n      GAME.data.direction = 0;\n      GAME.channel.perform(\"direction\", GAME.data);\n  }\n};\n\nPONG.display = function (event) {\n  if (event && $(event.currentTarget).val() == \"Pong\" || window.location.hash == \"#pong\") {\n    window.location.hash = \"#pong\";\n    /* --- chat --- */\n\n    unsubAll();\n    /* ------------ */\n\n    PONG.view = new PONG.View({\n      el: $(\"#main\")\n    });\n    $(\"#pongPlay input[value='Start']\").on(\"click\", PONG.start);\n  } else {\n    PONG.view = null;\n    $(document).off(\"keydown\");\n    $(document).off(\"keyup\");\n  }\n};\n\n$(\"#nav input[type='button']\").on(\"click\", PONG.display);","map":{"version":3,"sources":["/pong_rails/app/javascript/channels/pong_channel.js"],"names":["consumer","unsubAll","PONG","GAME","channel","subscriptions","create","received","data","action","view","View","el","$","html","playerLeft","playerRight","off","on","stop","document","keydown","keyup","host","initialize","width","height","fill","loop","direction","score","attributes","game","leftPaddleDirectionY","rightPaddleDirectionY","perform","render","ball","leftPaddle","rightPaddle","start","players","count","event","repeat","key","display","currentTarget","val","window","location","hash"],"mappings":"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","sourcesContent":["import consumer from \"./consumer\";\n\n/* --- chat --- */\nimport {unsubAll} from '../chat/index'\n/* ------------ */\n\nimport PONG from \"../nav/pong\";\nimport GAME from \"../nav/game\";\n\nGAME.channel = consumer.subscriptions.create(\"PongChannel\", {\n\treceived(data) {\n\t\tswitch (data.action) {\n\t\t\tcase 0:\n\t\t\t\tif (PONG.view == null) {\n\n\t\t\t\t\t/* --- chat --- */\n\t\t\t\t\tunsubAll();\n\t\t\t\t\t/* ------------ */\n\n\t\t\t\t\tPONG.view = new PONG.View({ el: $(\"#main\") });\n\t\t\t\t}\n\n\t\t\t\t$('#playerleft').html('[' + data.playerLeft + ']' + ' ');\n\t\t\t\t$('#playerright').html(' ' + '[' + data.playerRight + ']');\n\n\t\t\t\t$(\"#pongPlay input[value='Start']\").off(\"click\");\n\t\t\t\t$(\"#pongPlay input[value='Stop']\").on(\"click\", PONG.stop);\n\t\t\t\t$(document).on(\"keydown\", PONG.keydown);\n\t\t\t\t$(document).on(\"keyup\", PONG.keyup);\n\t\t\t\tif (data.host == true) {\n\t\t\t\t\tGAME.initialize(\n\t\t\t\t\t\tdata.playerLeft,\n\t\t\t\t\t\tdata.playerRight,\n\t\t\t\t\t\tPONG.width,\n\t\t\t\t\t\tPONG.height,\n\t\t\t\t\t\tPONG.fill\n\t\t\t\t\t);\n\t\t\t\t\tGAME.loop();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tGAME.data = {\n\t\t\t\t\t\tplayerLeft: data.playerLeft,\n\t\t\t\t\t\tplayerRight: data.playerRight,\n\t\t\t\t\t\tdirection: 0,\n\t\t\t\t\t\tscore: {},\n\t\t\t\t\t\tattributes: {}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tGAME.game = false;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tGAME.leftPaddleDirectionY = data.direction;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tGAME.rightPaddleDirectionY = data.direction;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tGAME.channel.perform(\"reset\", data);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (PONG.score){\n\t\t\t\t\tPONG.score.render(data.score);\n\t\t\t\t\tPONG.ball.render(data.ball);\n\t\t\t\t\tPONG.leftPaddle.render(data.leftPaddle);\n\t\t\t\t\tPONG.rightPaddle.render(data.rightPaddle);\n\t\t\t\t}\n\t\t}\n\t}\n});\n\nPONG.start = function() {\n\tif (PONG.players.count == 2) {\n\t\tGAME.channel.perform(\"start\", {\n\t\t\tplayerLeft: PONG.players.playerLeft,\n\t\t\tplayerRight: PONG.players.playerRight\n\t\t});\n\t}\n};\n\nPONG.stop = function() {\n\tGAME.channel.perform(\"stop\", GAME.data);\n};\n\nPONG.keydown = function (event) {\n\tif (event.repeat != true) {\n\t\tswitch (event.key) {\n\t\t\tcase \"w\":\n\t\t\t\tGAME.data.direction = -1;\n\t\t\t\tGAME.channel.perform(\"direction\", GAME.data);\n\t\t\t\tbreak;\n\t\t\tcase \"s\":\n\t\t\t\tGAME.data.direction = 1;\n\t\t\t\tGAME.channel.perform(\"direction\", GAME.data);\n\t\t}\n\t}\n};\n\nPONG.keyup = function (event) {\n\tswitch (event.key) {\n\t\tcase \"w\":\n\t\tcase \"s\":\n\t\t\tGAME.data.direction = 0;\n\t\t\tGAME.channel.perform(\"direction\", GAME.data);\n\t}\n};\n\nPONG.display = function (event) {\n\tif ((event && $(event.currentTarget).val() == \"Pong\")\n\t\t|| window.location.hash == \"#pong\") {\n\t\twindow.location.hash = \"#pong\";\n\n\t\t/* --- chat --- */\n\t\tunsubAll();\n\t\t/* ------------ */\n\n\t\tPONG.view = new PONG.View({ el: $(\"#main\") });\n\n\t\t$(\"#pongPlay input[value='Start']\").on(\"click\", PONG.start);\n\t}\n\telse {\n\t\tPONG.view = null;\n\n\t\t$(document).off(\"keydown\");\n\t\t$(document).off(\"keyup\");\n\t}\n};\n\n$(\"#nav input[type='button']\").on(\"click\", PONG.display);\n"]},"metadata":{},"sourceType":"module"}